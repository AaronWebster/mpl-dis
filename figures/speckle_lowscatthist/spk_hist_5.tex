% This file was created by matlab2tikz v0.4.7 running on MATLAB 8.3.
% Copyright (c) 2008--2014, Nico Schl√∂mer <nico.schloemer@gmail.com>
% All rights reserved.
% Minimal pgfplots version: 1.3
% 
\documentclass[tikz]{standalone}
\usepackage{pgfplots}
\usepackage{grffile}
\pgfplotsset{compat=newest}
\usetikzlibrary{plotmarks}
\usepackage{amsmath}

\begin{document}
%
% defining custom colors
\definecolor{mycolor1}{rgb}{0.12941,0.44314,0.70980}%
\definecolor{mycolor2}{rgb}{0.93725,0.95294,1.00000}%
\definecolor{mycolor3}{rgb}{0.13725,0.54510,0.27059}%
%
\begin{tikzpicture}

\begin{axis}[%
width=7cm,
height=4cm,
area legend,
scale only axis,
xmin=0,
xmax=3,
xlabel={$I/\bar{I}$},
ymin=0,
ymax=1.5,
ylabel={$\bar{I}p_I(I/\bar{I})$},
name=plot1,
axis x line*=bottom,
axis y line*=left,
legend style={draw=black,fill=white,legend cell align=left}
]
\addplot[ybar,bar width=0.231517925926147cm,draw=mycolor1,fill=mycolor2] plot table[row sep=crcr] {%
0.0496129326288206	0.880256725297545\\
0.148834900882884	0.866755289664563\\
0.248056869136948	0.780716930118722\\
0.347278837391011	0.693766865131808\\
0.446500805645075	0.621629452592004\\
0.545722773899139	0.563772010668572\\
0.644944742153202	0.525808186347\\
0.744166710407266	0.499040924352324\\
0.84338867866133	0.445598595295216\\
0.942610646915393	0.407706478143166\\
1.04183261516946	0.378706050011928\\
1.14105458342352	0.353209029305939\\
1.24027655167758	0.327292009464175\\
1.33949851993165	0.305001323623986\\
1.43872048818571	0.28280283271604\\
1.53794245643978	0.257182885433727\\
1.63716442469384	0.228295139997452\\
1.7363863929479	0.197440569339985\\
1.83560836120197	0.174719640482659\\
1.93483032945603	0.156608458237506\\
2.03405229771009	0.140269467467698\\
2.13327426596416	0.12365389190116\\
2.23249623421822	0.112344646879299\\
2.33171820247228	0.0981158956697298\\
2.43094017072635	0.090135912089993\\
2.53016213898041	0.0808856872215689\\
2.62938410723448	0.0742988715068439\\
2.72860607548854	0.0680091283515699\\
2.8278280437426	0.0623545058406395\\
2.92705001199667	0.0564130546516185\\
3.02627198025073	0.0491808744111895\\
3.12549394850479	0.0431164966458439\\
3.22471591675886	0.0399101617800446\\
3.32393788501292	0.0379126049147703\\
3.42315985326698	0.0349009037948183\\
3.52238182152105	0.031827739386704\\
3.62160378977511	0.0269004324523607\\
3.72082575802918	0.024114096722337\\
3.82004772628324	0.0207131281106905\\
3.9192696945373	0.0189102049912634\\
4.01849166279137	0.0159087477526718\\
4.11771363104543	0.0141160685146051\\
4.21693559929949	0.0118521707339609\\
4.31615756755356	0.0073551068167536\\
4.41537953580762	0.00521413561243396\\
4.51460150406168	0.00351365130661071\\
4.61382347231575	0.00238682435696879\\
4.71304544056981	0.00182341088214783\\
4.81226740882387	0.0011882902378042\\
4.91148937707794	0.000245853152649146\\
};
\addlegendentry{simulated};

\addplot [color=black,solid,forget plot]
  table[row sep=crcr]{%
0	0\\
3	0\\
};
\addplot [color=mycolor3,solid]
  table[row sep=crcr]{%
0	0.824834345825715\\
0.0404040404040404	0.828203345607034\\
0.0808080808080808	0.831627519537818\\
0.121212121212121	0.835108927199797\\
0.161616161616162	0.838649540815639\\
0.202020202020202	0.839069466231407\\
0.242424242424242	0.784980637580956\\
0.282828282828283	0.739765257753569\\
0.323232323232323	0.700979906668\\
0.363636363636364	0.667057867906589\\
0.404040404040404	0.636935259454944\\
0.444444444444444	0.60985712411651\\
0.484848484848485	0.585268706473135\\
0.525252525252525	0.562750570954957\\
0.565656565656566	0.541977986523347\\
0.606060606060606	0.522694429103267\\
0.646464646464647	0.504693727444953\\
0.686868686868687	0.487807651072691\\
0.727272727272727	0.471897076946459\\
0.767676767676768	0.456845564480347\\
0.808080808080808	0.442554586070592\\
0.848484848484849	0.42893990332828\\
0.888888888888889	0.415928858773891\\
0.929292929292929	0.403458168126987\\
0.96969696969697	0.39147224461544\\
1.01010101010101	0.379921827159682\\
1.05050505050505	0.368762876340369\\
1.09090909090909	0.357955645799091\\
1.13131313131313	0.347463920586409\\
1.17171717171717	0.337254321659868\\
1.21212121212121	0.327295728679604\\
1.25252525252525	0.317558718856901\\
1.29292929292929	0.308015026860415\\
1.33333333333333	0.298636993987806\\
1.37373737373737	0.289396957557953\\
1.41414141414141	0.280266537738428\\
1.45454545454545	0.271215719471247\\
1.4949494949495	0.262211630816824\\
1.53535353535354	0.253216620921173\\
1.57575757575758	0.244185562747644\\
1.61616161616162	0.235060715294822\\
1.65656565656566	0.225762388505434\\
1.6969696969697	0.216168273548808\\
1.73737373737374	0.206057035211398\\
1.77777777777778	0.194867454639437\\
1.81818181818182	0.180714570967516\\
1.85858585858586	0.170020792842077\\
1.8989898989899	0.161060092531157\\
1.93939393939394	0.153123101258983\\
1.97979797979798	0.145931489758431\\
2.02020202020202	0.13932987579208\\
2.06060606060606	0.133217130388835\\
2.1010101010101	0.12752131329588\\
2.14141414141414	0.122188227212709\\
2.18181818181818	0.117175335717853\\
2.22222222222222	0.112448310719222\\
2.26262626262626	0.10797867559445\\
2.3030303030303	0.103742508802267\\
2.34343434343434	0.0997193643745668\\
2.38383838383838	0.095891558642873\\
2.42424242424242	0.0922436590460492\\
2.46464646464646	0.0887620692507803\\
2.50505050505051	0.0854347322742147\\
2.54545454545455	0.0822508871624528\\
2.58585858585859	0.0792008741288659\\
2.62626262626263	0.0762759734808455\\
2.66666666666667	0.0734682748217692\\
2.70707070707071	0.0707706839449748\\
2.74747474747475	0.0681765649206414\\
2.78787878787879	0.0656799525251058\\
2.82828282828283	0.0632753389704223\\
2.86868686868687	0.0609576588332315\\
2.90909090909091	0.0587222334128656\\
2.94949494949495	0.0565647364023993\\
2.98989898989899	0.0544811561555547\\
3.03030303030303	0.0524677706909084\\
3.07070707070707	0.0505211117023627\\
3.11111111111111	0.0486379490886617\\
3.15151515151515	0.0468152660198064\\
3.19191919191919	0.0450502483092561\\
3.23232323232323	0.0433402312093488\\
3.27272727272727	0.0416827708923561\\
3.31313131313131	0.040075525034835\\
3.35353535353535	0.0385163125337347\\
3.39393939393939	0.0370030692653095\\
3.43434343434343	0.0355338659201566\\
3.47474747474747	0.0341068692108313\\
3.51515151515152	0.0327203535902012\\
3.55555555555556	0.031372695489372\\
3.5959595959596	0.0300623301809786\\
3.63636363636364	0.0287878180305725\\
3.67676767676768	0.0275477679891719\\
3.71717171717172	0.0263408653601265\\
3.75757575757576	0.0251658658795827\\
3.7979797979798	0.0240215827756596\\
3.83838383838384	0.022906892865076\\
3.87878787878788	0.0218207230563705\\
3.91919191919192	0.0207620556073658\\
3.95959595959596	0.0197299191932843\\
4	0.0187233873530493\\
};
\addlegendentry{analytic};

\addplot [color=black,dashed]
  table[row sep=crcr]{%
0	1.11803398874989\\
0.0404040404040404	1.06865268825965\\
0.0808080808080808	1.02145245995742\\
0.121212121212121	0.976336970295023\\
0.161616161616162	0.933214140582326\\
0.202020202020202	0.891995959058735\\
0.242424242424242	0.852598301265155\\
0.282828282828283	0.814940758349738\\
0.323232323232323	0.778946472957029\\
0.363636363636364	0.744541982365545\\
0.404040404040404	0.711657068553666\\
0.444444444444444	0.680224614887793\\
0.484848484848485	0.650180469140318\\
0.525252525252525	0.621463312557803\\
0.565656565656566	0.594014534712157\\
0.606060606060606	0.56777811387938\\
0.646464646464647	0.542700502701736\\
0.686868686868687	0.518730518900006\\
0.727272727272727	0.495819240812743\\
0.767676767676768	0.473919907549366\\
0.808080808080808	0.452987823553271\\
0.848484848484849	0.43298026738021\\
0.888888888888889	0.413856404505743\\
0.929292929292929	0.395577203983798\\
0.96969696969697	0.37810535878627\\
1.01010101010101	0.361405209661044\\
1.05050505050505	0.345442672353063\\
1.09090909090909	0.330185168039897\\
1.13131313131313	0.31560155683982\\
1.17171717171717	0.301662074256719\\
1.21212121212121	0.288338270432081\\
1.25252525252525	0.27560295208012\\
1.29292929292929	0.263430126987492\\
1.33333333333333	0.251794950964358\\
1.37373737373737	0.240673677138507\\
1.41414141414141	0.230043607489053\\
1.45454545454545	0.219883046520797\\
1.4949494949495	0.21017125698469\\
1.53535353535354	0.200888417554042\\
1.57575757575758	0.19201558237008\\
1.61616161616162	0.183534642374304\\
1.65656565656566	0.17542828834871\\
1.6969696969697	0.167679975588449\\
1.73737373737374	0.160273890134832\\
1.77777777777778	0.153194916499749\\
1.81818181818182	0.146428606815631\\
1.85858585858586	0.139961151348007\\
1.8989898989899	0.133779350310452\\
1.93939393939394	0.127870586924415\\
1.97979797979798	0.122222801668943\\
2.02020202020202	0.116824467667737\\
2.06060606060606	0.111664567163314\\
2.1010101010101	0.106732569030261\\
2.14141414141414	0.102018407281679\\
2.18181818181818	0.0975124605249573\\
2.22222222222222	0.0932055323249392\\
2.26262626262626	0.0890888324344135\\
2.3030303030303	0.0851539588536134\\
2.34343434343434	0.081392880682112\\
2.38383838383838	0.0777979217281148\\
2.42424242424242	0.0743617448416967\\
2.46464646464646	0.0710773369400082\\
2.50505050505051	0.0679379946938881\\
2.54545454545455	0.0649373108466695\\
2.58585858585859	0.0620691611372559\\
2.62626262626263	0.0593276918007797\\
2.66666666666667	0.0567073076213305\\
2.70707070707071	0.0542026605123705\\
2.74747474747475	0.0518086386015298\\
2.78787878787879	0.0495203557975043\\
2.82828282828283	0.0473331418177626\\
2.86868686868687	0.0452425326567087\\
2.90909090909091	0.0432442614748473\\
2.94949494949495	0.0413342498903554\\
2.98989898989899	0.0395085996552882\\
3.03030303030303	0.03776358469943\\
3.07070707070707	0.0360956435255518\\
3.11111111111111	0.0345013719405556\\
3.15151515151515	0.0329775161076689\\
3.19191919191919	0.0315209659055097\\
3.23232323232323	0.0301287485804684\\
3.27272727272727	0.0287980226794512\\
3.31313131313131	0.0275260722506017\\
3.35353535353535	0.026310301300165\\
3.39393939393939	0.0251482284941809\\
3.43434343434343	0.0240374820941927\\
3.47474747474747	0.0229757951166355\\
3.51515151515152	0.0219610007060242\\
3.55555555555556	0.0209910277124991\\
3.5959595959596	0.0200638964647014\\
3.63636363636364	0.0191777147293534\\
3.67676767676768	0.0183306738492946\\
3.71717171717172	0.0175210450520943\\
3.75757575757576	0.0167471759217042\\
3.7979797979798	0.0160074870259513\\
3.83838383838384	0.0153004686929881\\
3.87878787878788	0.0146246779301198\\
3.91919191919192	0.0139787354787211\\
3.95959595959596	0.0133613229992309\\
4	0.0127711803804811\\
};
\addlegendentry{$N=\infty$};

\node[right, inner sep=0mm, text=black]
at (axis cs:1,1,0) {$N=5$};
\end{axis}

\begin{axis}[%
width=4cm,
height=4cm,
axis on top,
scale only axis,
xmin=0,
xmax=1000,
xtick={0,500,1000},
xticklabels={\empty},
xlabel={x},
ymin=0,
ymax=1000,
ytick={0,500,1000},
yticklabels={\empty},
ylabel={y},
at=(plot1.right of south east),
anchor=left of south west,
axis x line*=bottom,
axis y line*=left,
colormap={mymap}{[1pt] rgb(0pt)=(1,0.960784,0.941176); rgb(5pt)=(0.996265,0.901027,0.855275); rgb(6pt)=(0.996078,0.895238,0.847059); rgb(10pt)=(0.996078,0.880299,0.826144); rgb(11pt)=(0.995331,0.864613,0.805229); rgb(15pt)=(0.989356,0.754062,0.658824); rgb(16pt)=(0.988235,0.730906,0.628385); rgb(21pt)=(0.988235,0.682353,0.568627); rgb(26pt)=(0.988235,0.577778,0.452848); rgb(27pt)=(0.987675,0.55014,0.42465); rgb(31pt)=(0.984687,0.430626,0.305135); rgb(32pt)=(0.979832,0.398133,0.278992); rgb(36pt)=(0.943978,0.257703,0.189356); rgb(37pt)=(0.93408,0.228758,0.171429); rgb(42pt)=(0.870588,0.176471,0.14902); rgb(47pt)=(0.799627,0.0980392,0.115406); rgb(48pt)=(0.77479,0.0890756,0.109244); rgb(52pt)=(0.661251,0.0621849,0.0853408); rgb(53pt)=(0.642577,0.0532213,0.0793651); rgb(57pt)=(0.606723,0.00840336,0.0554622); rgb(58pt)=(0.590663,0,0.0509804); rgb(63pt)=(0.403922,0,0.0509804)},
colorbar,
colorbar style={title={$I/\bar{I}$}},
point meta min=2.00311579606466e-06,
point meta max=5.10015364460918
]
\addplot [forget plot] graphics [xmin=0.5,xmax=1000.5,ymin=0.5,ymax=1000.5] {spk_hist_5-1.png};
\addplot[only marks,mark=o,mark options={},color=black] plot table[row sep=crcr,]{%
570.892489230996	927.112147047291\\
863.765569817539	169.839250866394\\
178.699029167114	243.504367623195\\
751.779355061302	199.134375117022\\
982.940511503982	709.63870247907\\
};
\end{axis}
\end{tikzpicture}%
\end{document}

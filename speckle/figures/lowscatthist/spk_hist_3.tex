% This file was created by matlab2tikz v0.4.7 running on MATLAB 8.3.
% Copyright (c) 2008--2014, Nico Schl√∂mer <nico.schloemer@gmail.com>
% All rights reserved.
% Minimal pgfplots version: 1.3
% 
\documentclass[tikz]{standalone}
\usepackage{pgfplots}
\usepackage{grffile}
\pgfplotsset{compat=newest}
\usetikzlibrary{plotmarks}
\usepackage{amsmath}

\begin{document}
%
% defining custom colors
\definecolor{mycolor1}{rgb}{0.12941,0.44314,0.70980}%
\definecolor{mycolor2}{rgb}{0.93725,0.95294,1.00000}%
\definecolor{mycolor3}{rgb}{0.13725,0.54510,0.27059}%
%
\begin{tikzpicture}

\begin{axis}[%
width=7cm,
height=4cm,
area legend,
scale only axis,
xmin=0,
xmax=3,
xlabel={$I/\bar{I}$},
ymin=0,
ymax=1.5,
ylabel={$\bar{I}p_I(I/\bar{I})$},
name=plot1,
axis x line*=bottom,
axis y line*=left,
legend style={draw=black,fill=white,legend cell align=left}
]
\addplot[ybar,bar width=0.139998034715344cm,draw=mycolor1,fill=mycolor2] plot table[row sep=crcr] {%
0.0300003703900839	0.598719213660514\\
0.0899995281252321	0.62724910681686\\
0.14999868586038	0.669890743067843\\
0.209997843595528	0.771702969182467\\
0.269997001330677	0.909279697398214\\
0.329996159065825	1.24542516288651\\
0.389995316800973	0.870178763877852\\
0.449994474536121	0.690522145517421\\
0.509993632271269	0.600217203277315\\
0.569992790006417	0.531173500030213\\
0.629991947741566	0.482693108795562\\
0.689991105476714	0.443728356149454\\
0.749990263211862	0.415845322145817\\
0.80998942094701	0.386685592446043\\
0.869988578682158	0.369050169230068\\
0.929987736417306	0.34804426937629\\
0.989986894152454	0.334443204560108\\
1.0499860518876	0.317880205728887\\
1.10998520962275	0.303921666117787\\
1.1699843673579	0.292942083131007\\
1.22998352509305	0.283068969747546\\
1.28998268282819	0.272378771118557\\
1.34998184056334	0.26543354653157\\
1.40998099829849	0.255322116618163\\
1.46998015603364	0.249925949475823\\
1.52997931376879	0.244019104055029\\
1.58997847150394	0.236341907268923\\
1.64997762923908	0.22932859224481\\
1.70997678697423	0.224562261645897\\
1.76997594470938	0.219319297987094\\
1.82997510244453	0.214689148262436\\
1.88997426017968	0.205735255780194\\
1.94997341791482	0.186925272523772\\
2.00997257564997	0.181682308864968\\
2.06997173338512	0.179911957499658\\
2.12997089112027	0.18169933147425\\
2.18997004885542	0.176524458252574\\
2.24996920659057	0.171979421574325\\
2.30996836432571	0.172456054634217\\
2.36996752206086	0.166855616180495\\
2.42996667979601	0.166430050948449\\
2.48996583753116	0.163195755184901\\
2.54996499526631	0.16346811693341\\
2.60996415300145	0.159586962017153\\
2.6699633107366	0.155961146240124\\
2.72996246847175	0.143075031013778\\
2.7899616262069	0.139942870905922\\
2.84996078394205	0.136657507314529\\
2.9099599416772	0.135193562916291\\
2.96995909941234	0.131346453218598\\
};
\addlegendentry{simulated};

\addplot [color=black,solid,forget plot]
  table[row sep=crcr]{%
0	0\\
3	0\\
};
\addplot [color=mycolor3,solid]
  table[row sep=crcr]{%
0	0.547978631966573\\
0.0404040404040404	0.575204703411436\\
0.0808080808080808	0.603121264090866\\
0.121212121212121	0.636383042984547\\
0.161616161616162	0.677352509140088\\
0.202020202020202	0.730550570833488\\
0.242424242424242	0.805017101064371\\
0.282828282828283	0.92751180892556\\
0.323232323232323	1.27871706829209\\
0.363636363636364	1.00627428822922\\
0.404040404040404	0.80461644320532\\
0.444444444444444	0.697599454188648\\
0.484848484848485	0.625365336586515\\
0.525252525252525	0.57149631108687\\
0.565656565656566	0.528884694419824\\
0.606060606060606	0.494009521019314\\
0.646464646464647	0.464727090811041\\
0.686868686868687	0.439603054068843\\
0.727272727272727	0.417727345670654\\
0.767676767676768	0.398451816712804\\
0.808080808080808	0.381280407328903\\
0.848484848484849	0.365886602455863\\
0.888888888888889	0.351984847437672\\
0.929292929292929	0.33932418861749\\
0.96969696969697	0.32772442350865\\
1.01010101010101	0.317077005392144\\
1.05050505050505	0.30724901900147\\
1.09090909090909	0.298123690272488\\
1.13131313131313	0.289659133912653\\
1.17171717171717	0.281741814046681\\
1.21212121212121	0.27435877341664\\
1.25252525252525	0.267414593551836\\
1.29292929292929	0.260864642610502\\
1.33333333333333	0.254709278884758\\
1.37373737373737	0.248892252145551\\
1.41414141414141	0.243405626810484\\
1.45454545454545	0.238170962722293\\
1.4949494949495	0.233208124685218\\
1.53535353535354	0.228492437636427\\
1.57575757575758	0.223998279397927\\
1.61616161616162	0.219709931207065\\
1.65656565656566	0.215613617653289\\
1.6969696969697	0.211695661232562\\
1.73737373737374	0.207945325881707\\
1.77777777777778	0.204357773499029\\
1.81818181818182	0.200908661275374\\
1.85858585858586	0.197580681420692\\
1.8989898989899	0.194392806547648\\
1.93939393939394	0.191327631106865\\
1.97979797979798	0.188363392214917\\
2.02020202020202	0.185525080625248\\
2.06060606060606	0.182761457877562\\
2.1010101010101	0.180106251306389\\
2.14141414141414	0.17755628767547\\
2.18181818181818	0.175060857563808\\
2.22222222222222	0.17266376713016\\
2.26262626262626	0.170343932916111\\
2.3030303030303	0.168097572597329\\
2.34343434343434	0.165900112364965\\
2.38383838383838	0.163797560565669\\
2.42424242424242	0.1617367040478\\
2.46464646464646	0.159739094035671\\
2.50505050505051	0.157806331265782\\
2.54545454545455	0.155901162971124\\
2.58585858585859	0.154067079439218\\
2.62626262626263	0.152312222820067\\
2.66666666666667	0.150571349608925\\
2.70707070707071	0.148881059654564\\
2.74747474747475	0.147250275929424\\
2.78787878787879	0.145617153258\\
2.82828282828283	0.144092277998954\\
2.86868686868687	0.14255675708073\\
2.90909090909091	0.141044919033948\\
2.94949494949495	0.139575517035745\\
2.98989898989899	0.138585271661462\\
3.03030303030303	-0.00010706836650261\\
3.07070707070707	-6.5449623147476e-05\\
3.11111111111111	3.76775255193107e-05\\
3.15151515151515	3.01422043329243e-05\\
3.19191919191919	-1.87062963611084e-06\\
3.23232323232323	1.54838170005656e-05\\
3.27272727272727	1.22106822636171e-05\\
3.31313131313131	2.88136315973681e-06\\
3.35353535353535	9.32348108020816e-06\\
3.39393939393939	8.39996057519503e-06\\
3.43434343434343	1.94608488761759e-06\\
3.47474747474747	6.02066303053361e-06\\
3.51515151515152	4.04178578507268e-06\\
3.55555555555556	5.90566801526286e-06\\
3.5959595959596	-2.76360495200296e-06\\
3.63636363636364	-6.00020744941435e-06\\
3.67676767676768	-5.53779749016894e-07\\
3.71717171717172	1.86102711127099e-06\\
3.75757575757576	5.07083764357021e-06\\
3.7979797979798	5.0287833701936e-06\\
3.83838383838384	-7.08916302419852e-07\\
3.87878787878788	2.65521890882635e-06\\
3.91919191919192	-1.6645950252415e-06\\
3.95959595959596	1.12173615010624e-06\\
4	2.25605680207497e-06\\
};
\addlegendentry{analytic};

\addplot [color=black,dashed]
  table[row sep=crcr]{%
0	1.22474487139159\\
0.0404040404040404	1.16561391371839\\
0.0808080808080808	1.10933781197234\\
0.121212121212121	1.05577873306762\\
0.161616161616162	1.00480549853074\\
0.202020202020202	0.956293263214402\\
0.242424242424242	0.910123209523098\\
0.282828282828283	0.866182256401522\\
0.323232323232323	0.824362782373138\\
0.363636363636364	0.784562361950488\\
0.404040404040404	0.746683514771671\\
0.444444444444444	0.710633466848569\\
0.484848484848485	0.676323923342059\\
0.525252525252525	0.643670852307703\\
0.565656565656566	0.612594278882223\\
0.606060606060606	0.583018089406719\\
0.646464646464647	0.554869845006847\\
0.686868686868687	0.528080604173402\\
0.727272727272727	0.502584753908737\\
0.767676767676768	0.478319849025479\\
0.808080808080808	0.455226459203939\\
0.848484848484849	0.433248023433619\\
0.888888888888889	0.412330711482319\\
0.929292929292929	0.392423292053554\\
0.96969696969697	0.373477007309342\\
1.01010101010101	0.355445453451084\\
1.05050505050505	0.338284467066004\\
1.09090909090909	0.321952016960821\\
1.13131313131313	0.306408101217715\\
1.17171717171717	0.291614649220447\\
1.21212121212121	0.27753542841069\\
1.25252525252525	0.264135955546174\\
1.29292929292929	0.251383412243319\\
1.33333333333333	0.239246564597478\\
1.37373737373737	0.227695686683943\\
1.41414141414141	0.216702487752331\\
1.45454545454545	0.206240042936048\\
1.4949494949495	0.196282727307108\\
1.53535353535354	0.186806153114812\\
1.57575757575758	0.177787110054542\\
1.61616161616162	0.169203508420406\\
1.65656565656566	0.161034325002478\\
1.6969696969697	0.153259551596132\\
1.73737373737374	0.145860145997358\\
1.77777777777778	0.138817985364036\\
1.81818181818182	0.132115821828937\\
1.85858585858586	0.125737240255739\\
1.8989898989899	0.119666618034591\\
1.93939393939394	0.113889086818756\\
1.97979797979798	0.108390496108621\\
2.02020202020202	0.103157378593873\\
2.06060606060606	0.098176917168971\\
2.1010101010101	0.0934369135411071\\
2.14141414141414	0.0889257583537935\\
2.18181818181818	0.084632402752883\\
2.22222222222222	0.0805463313253897\\
2.26262626262626	0.0766575363448304\\
2.3030303030303	0.0729564932600059\\
2.34343434343434	0.0694341373671897\\
2.38383838383838	0.0660818416085885\\
2.42424242424242	0.0628913954426985\\
2.46464646464646	0.0598549847348052\\
2.50505050505051	0.0569651726183744\\
2.54545454545455	0.0542148812804597\\
2.58585858585859	0.0515973746265147\\
2.62626262626263	0.0491062417821516\\
2.66666666666667	0.0467353813914393\\
2.70707070707071	0.044478986673282\\
2.74747474747475	0.0423315311992808\\
2.78787878787879	0.0402877553582419\\
2.82828282828283	0.0383426534741819\\
2.86868686868687	0.0364914615462794\\
2.90909090909091	0.0347296455807432\\
2.94949494949495	0.0330528904860214\\
2.98989898989899	0.0314570895041522\\
3.03030303030303	0.0299383341523714\\
3.07070707070707	0.0284929046503408\\
3.11111111111111	0.0271172608095533\\
3.15151515151515	0.0258080333625986\\
3.19191919191919	0.0245620157110542\\
3.23232323232323	0.0233761560717902\\
3.27272727272727	0.0222475500024522\\
3.31313131313131	0.0211734332878153\\
3.35353535353535	0.0201511751695873\\
3.39393939393939	0.0191782719030774\\
3.43434343434343	0.0182523406249513\\
3.47474747474747	0.017371113517052\\
3.51515151515152	0.0165324322519931\\
3.55555555555556	0.0157342427069191\\
3.5959595959596	0.0149745899324881\\
3.63636363636364	0.0142516133647517\\
3.67676767676768	0.0135635422682069\\
3.71717171717172	0.0129086913988592\\
3.75757575757576	0.0122854568766724\\
3.7979797979798	0.0116923122572995\\
3.83838383838384	0.0111278047934694\\
3.87878787878788	0.0105905518768757\\
3.91919191919192	0.010079237651852\\
3.95959595959596	0.00959260979253902\\
4	0.00912947643565167\\
};
\addlegendentry{$N=\infty$};

\node[right, inner sep=0mm, text=black]
at (axis cs:1,1,0) {$N=3$};
\end{axis}

\begin{axis}[%
width=4cm,
height=4cm,
axis on top,
scale only axis,
xmin=0,
xmax=1000,
xtick={0,500,1000},
xticklabels={\empty},
xlabel={x},
ymin=0,
ymax=1000,
ytick={0,500,1000},
yticklabels={\empty},
ylabel={y},
at=(plot1.right of south east),
anchor=left of south west,
axis x line*=bottom,
axis y line*=left,
colormap={mymap}{[1pt] rgb(0pt)=(1,0.960784,0.941176); rgb(5pt)=(0.996265,0.901027,0.855275); rgb(6pt)=(0.996078,0.895238,0.847059); rgb(10pt)=(0.996078,0.880299,0.826144); rgb(11pt)=(0.995331,0.864613,0.805229); rgb(15pt)=(0.989356,0.754062,0.658824); rgb(16pt)=(0.988235,0.730906,0.628385); rgb(21pt)=(0.988235,0.682353,0.568627); rgb(26pt)=(0.988235,0.577778,0.452848); rgb(27pt)=(0.987675,0.55014,0.42465); rgb(31pt)=(0.984687,0.430626,0.305135); rgb(32pt)=(0.979832,0.398133,0.278992); rgb(36pt)=(0.943978,0.257703,0.189356); rgb(37pt)=(0.93408,0.228758,0.171429); rgb(42pt)=(0.870588,0.176471,0.14902); rgb(47pt)=(0.799627,0.0980392,0.115406); rgb(48pt)=(0.77479,0.0890756,0.109244); rgb(52pt)=(0.661251,0.0621849,0.0853408); rgb(53pt)=(0.642577,0.0532213,0.0793651); rgb(57pt)=(0.606723,0.00840336,0.0554622); rgb(58pt)=(0.590663,0,0.0509804); rgb(63pt)=(0.403922,0,0.0509804)},
colorbar,
colorbar style={title={$I/\bar{I}$}},
point meta min=7.91965569590243e-07,
point meta max=3.00163792416869
]
\addplot [forget plot] graphics [xmin=0.5,xmax=1000.5,ymin=0.5,ymax=1000.5] {spk_hist_3-1.png};
\addplot[only marks,mark=o,mark options={},color=black] plot table[row sep=crcr,]{%
151.868701454032	380.664274287961\\
821.019401441083	171.3643793428\\
329.975281417833	966.471986909258\\
};
\end{axis}
\end{tikzpicture}%
\end{document}
